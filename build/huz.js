!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var i in n)("object"==typeof exports?exports:e)[i]=n[i]}}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function i(e,t){var n=new s.Parser(t),i=n.parse(e);if(null===i)throw n.error;return i}function r(e,t){return new o.Renderer(i(e),t)}function a(e,t,n){var i=r(e,n),a=i.render(t);if(i.error)throw i.error;return a}Object.defineProperty(t,"__esModule",{value:!0}),t.parse=i,t.compile=r,t.render=a;var s=n(2),o=n(5),l=n(4);Object.defineProperty(t,"Tokenizer",{enumerable:!0,get:function(){return l.Tokenizer}}),t.Parser=s.Parser,t.Renderer=o.Renderer},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="ROOT";t.ROOT=n;var i="VARIABLE";t.VARIABLE=i;var r="SECTION";t.SECTION=r;var a="TEXT";t.TEXT=a;var s="COMMENT";t.COMMENT=s;var o="PARTIAL";t.PARTIAL=o;var l="DELIMITER_CHANGE";t.DELIMITER_CHANGE=l},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(3),o=i(s),l=n(1),h=i(l),c=n(4),u=function(){function e(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];r(this,e),this._delimiters=n.delimiters?n.delimiters:["{{","}}"],this._error=null,this._stack=null,this._lastToken=null,this._filename=t,this._src=null}return a(e,[{key:"parse",value:function(e){var t={type:h.ROOT,children:[]};return this._src=e,this._error=null,this._stack=[t],this._lastToken=null,this._parseNodes(e),this._error?null:t}},{key:"_pushNode",value:function(e){return this._stack[this._stack.length-1].children.push(e),e}},{key:"_getTop",value:function(){return this._stack[this._stack.length-1]}},{key:"_clone",value:function(e){return JSON.parse(JSON.stringify(e))}},{key:"_makeLocation",value:function(e,t){var n=this._clone(e);return this._filename&&(n.filename=this._filename),t&&(n.endIndex=t.endIndex,n.endLine=t.endLine),n}},{key:"_parseNodes",value:function(e){var t=this._stack.length,n=void 0,i=new c.Tokenizer(e,{delimiters:this._delimiters.slice(0)});do{if(n=i.getNextToken(),null!==i.error)return this._error=i.error,null;switch(this._lastToken=n,n.type){case o.TEXT:this._pushNode({type:h.TEXT,text:n.text,location:this._makeLocation(n.location)});break;case o.VARIABLE:case o.UNESCAPED_VARIABLE:this._pushNode({type:h.VARIABLE,name:n.name,unescaped:n.type===o.UNESCAPED_VARIABLE,location:this._makeLocation(n.location)});break;case o.SECTION_OPEN:this._handleSectionOpen(n);break;case o.INVERTED_SECTION_OPEN:this._handleSectionOpen(n,!0);break;case o.SECTION_CLOSE:this._handleSectionClose(n);break;case o.PARTIAL:this._pushNode({type:h.PARTIAL,name:n.name,indent:n.indent,location:this._makeLocation(n.location)});break;case o.COMMENT:this._handleComment(n);break;case o.DELIMITER_CHANGE:this._pushNode({type:h.DELIMITER_CHANGE,delimiters:n.delimiters,location:this._makeLocation(n.location)})}}while(n.type!==o.EOF&&null===this._error);this._error||(this._stack.length>t?this._setError("Unexpected EOF: sections not closed: "+this._stack.slice(t).map(function(e){return"'"+e.name+"'"}).join(", ")):this._stack.length<t&&this._setError("Internal error."))}},{key:"_setError",value:function(e){this._error=new Error(e),this._error.location=this._lastToken.location}},{key:"_handleSectionOpen",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],n=e.name,i=e.location;this._stack.push({type:h.SECTION,name:n,children:[],inverted:t,location:i})}},{key:"_handleSectionClose",value:function(e){var t=e.name,n=e.location,i=this._stack.pop();return i.type!==h.SECTION?void this._setError("Unexpected SECTION_CLOSE: "+this._token.name):i.name!==t?void this._setError("Unexpected SECTION_CLOSE: '"+t+"', current section: '"+i.name+"'"):(i.raw=this._src.slice(i.location.endIndex,n.index),i.location=this._makeLocation(i.location,e.location),void this._pushNode(i))}},{key:"_handleComment",value:function(e){var t=e.content,n=e.location;this._pushNode({type:h.COMMENT,content:t,location:this._makeLocation(n)})}},{key:"error",get:function(){return this._error}}]),e}();t.Parser=u},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="EOF";t.EOF=n;var i="TEXT";t.TEXT=i;var r="PARTIAL";t.PARTIAL=r;var a="INVERTED_SECTION_OPEN";t.INVERTED_SECTION_OPEN=a;var s="SECTION_OPEN";t.SECTION_OPEN=s;var o="SECTION_CLOSE";t.SECTION_CLOSE=o;var l="UNESCAPED_VARIABLE";t.UNESCAPED_VARIABLE=l;var h="COMMENT";t.COMMENT=h;var c="VARIABLE";t.VARIABLE=c;var u="DELIMITER_CHANGE";t.DELIMITER_CHANGE=u},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e){return/^\s*$/.test(e)}function s(e){var t=e.match(/=[\s\n]*([^\s\n]*?)[\s\n]+([^\s\n]*?)[\s\n]*=[\s\n]*$/);return t?t.slice(1):null}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){var n=[],i=!0,r=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(i=(s=o.next()).done)&&(n.push(s.value),!t||n.length!==t);i=!0);}catch(l){r=!0,a=l}finally{try{!i&&o["return"]&&o["return"]()}finally{if(r)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),h=n(3),c=i(h),u="STATE_NONE",_="STATE_EOF",d="STATE_TEXT",p="STATE_TEXT_BREAK",k="STATE_TAG",f=0,v=1,m=function(){function e(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];r(this,e),this._src=t,this._index=0,this._char=null,this._tokens=[],this._line=0,this._column=0,this._state=u,this._error=null,this._location={index:0,line:0,column:0},this._delimiters=n.delimiters?n.delimiters:["{{","}}"]}return l(e,[{key:"getNextToken",value:function(){if(this._tokens.length>0)return this._tokens.shift();var e=!1;do{if(null!==this._error)return null;switch(this._state!==u&&this._markLocation(),this._state){case u:this._read();break;case _:this._handleEOF(),e=!0;break;case d:this._handleText();break;case p:this._handleTextBreak(),e=!0;break;case k:this._handleTag()}this._state===u&&(null===this._char?this._state=_:"\n"===this._char?this._state=p:this._isDelimiter(f)?this._state=k:this._state=d)}while(!e);return null===this._error?this._tokens.shift():null}},{key:"_handleEOF",value:function(){this._handleStandaloneTag(),this._makeToken({type:c.EOF})}},{key:"_handleTag",value:function(){var e=o(this._delimiters,2),t=e[0],n=e[1];if(this._skip(t.length),this._skipAllWhitespaces(),null===this._char)this._makeError("Unclosed tag.");else if(this._isDelimiter(v))this._handleEmptyTag();else{var i=this._char;if("{"===i)this._handleVariableCurly();else{for(var r=this._index-1;!this._isDelimiter(v)&&null!==this._char;)this._read();if(null===this._char)this._makeError("Unclosed tag.");else{var a=this._src.slice(r,this._index-1);switch(i){case">":this._handleSimpleTag(c.PARTIAL,a);break;case"^":this._handleSimpleTag(c.INVERTED_SECTION_OPEN,a);break;case"#":this._handleSimpleTag(c.SECTION_OPEN,a);break;case"/":this._handleSimpleTag(c.SECTION_CLOSE,a);break;case"!":this._handleComment(a.substr(1));break;case"=":this._handleDelimiterChange(a);break;case"&":this._handleVariable(a.substr(1),!0);break;default:this._handleVariable(a)}}}}if(null===this._error){for(var s=0;s<n.length;s++)this._read();this._tokens[this._tokens.length-1].location.endIndex=this._index-1}this._state=u}},{key:"_handleDelimiterChange",value:function(e){var t=s(e);if(null===t)this._makeError("Invalid change delimiter syntax.");else{var n=o(t,2),i=n[0],r=n[1];this._delimiters=t,this._makeToken({type:c.DELIMITER_CHANGE,delimiters:[i,r]})}}},{key:"_handleSimpleTag",value:function(e,t){this._makeToken({type:e,name:t.substr(1).trim()})}},{key:"_handleComment",value:function(e){this._makeToken({type:c.COMMENT,content:e})}},{key:"_handleVariableCurly",value:function(){this._read();var e=this._index-1,t=this._distance("}");if(-1===t)this._makeError("Unclosed variable tag: missingright curly.");else{var n=this._src.slice(e,e+t);this._skip(t+1),this._skipAllWhitespaces(),this._isDelimiter(v)?this._makeToken({type:c.UNESCAPED_VARIABLE,name:n.trim()}):this._makeError("Unclosed variable: missing right delimiter.")}}},{key:"_handleEmptyTag",value:function(){this._makeToken({type:c.VARIABLE,name:""})}},{key:"_handleVariable",value:function(e,t){this._makeToken({type:t?c.UNESCAPED_VARIABLE:c.VARIABLE,name:e.trim()})}},{key:"_handleText",value:function(){var e=!1,t=this._index-1,n=0;do{var i=this._char;null===i||"\n"===i||this._isDelimiter(f)?e=!0:n++,e||this._read()}while(!e);this._makeToken({type:c.TEXT,text:this._src.slice(t,t+n)}),this._state=u}},{key:"_handleTextBreak",value:function(){this._makeToken({type:c.TEXT,text:"\n"}),this._read(),this._handleStandaloneTag(),this._state=u}},{key:"_handleStandaloneTag",value:function(){for(var e=!0,t=null,n="",i=0;e&&i<this._tokens.length;i++){var r=this._tokens[i];switch(r.type){case c.VARIABLE:case c.UNESCAPED_VARIABLE:e=!1;break;case c.TEXT:e=a(r.text),e&&null===t&&(n+=r.text);break;default:e=null===t,e&&(t=r)}}e&&t&&(t.type===c.PARTIAL&&(t.indent=n),this._tokens=[t])}},{key:"_dump",value:function(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];console.log(e+">"+this._src.slice(this._index-1))}},{key:"_read",value:function(){this._index<this._src.length?("\n"===this._char?(this._line++,this._column=0):this._column++,this._char=this._src[this._index],this._index++):this._char=null}},{key:"_peek",value:function(){return this._index<this._src.length-1?this._src[this._index]:null}},{key:"_skip",value:function(e){for(var t=0;e>t;t++)this._read()}},{key:"_distance",value:function(e){for(var t=this._index;t<this._src.length;t++)if(this._src[t]===e)return t-this._index+1;return-1}},{key:"_skipAllWhitespaces",value:function(){for(;this._isWhitespace();)this._read()}},{key:"_markLocation",value:function(){this._location.index=this._index-1,this._location.line=this._line,this._location.column=this._column}},{key:"_isWhitespace",value:function(){return/\s/.test(this._char)}},{key:"_isDelimiter",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n=this._delimiters[e],i=this._index-1+t;return this._src.slice(i,i+n.length)===n}},{key:"_makeToken",value:function(e){var t=this._location,n=t.index,i=t.line,r=t.column;e.location={index:n,line:i,column:r,endIndex:this._index,endLine:this._line,endColumn:this._column},this._tokens.push(e)}},{key:"_makeError",value:function(e){var t=new Error(e);t.index=this._index-1,t.line=this._line,t.column=this._column,this._error=t}},{key:"error",get:function(){return this._error}}]),e}();t.Tokenizer=m},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e){return"[object Function]"==Object.prototype.toString.call(e)}function o(e,t){for(var n=e.children.slice(0).reverse();n.length;){var i=n.pop();t(i),void 0!==i.children&&(n=n.concat(i.children.slice(0).reverse()))}}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),h=n(1),c=r(h),u=n(6),_=i(u),d=n(2),p="_REPEATER",k=10,f=function(){function e(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];a(this,e),this._partials=n.partials||{},this._delimiters=n.delimiters?n.delimiters:["{{","}}"],this._partialCached={},this._root=t,this._stack=null,this._contextStack=null,this._partialStack=null,this._error=null}return l(e,[{key:"render",value:function(e){this._stack=[],this._contextStack=[],this._partialStack=[],this._pushContext(e),this._stack=this._root.children.slice(0).reverse();for(var t="",n=!0;null===this._error&&this._stack.length>0;){var i=this._stack[this._stack.length-1],r=this._partialStack.length?this._partialStack[this._partialStack.length-1]:null;i.type in c&&n&&null!==r&&r.indent.length>0&&(t+=r.indent);var a=void 0;switch(i.type){case c.VARIABLE:a=this._getValue(i.name),s(a)?(this._popNode(),this._expandLambda(i,a)):(a&&(t+=i.unescaped?a:_["default"](a)),this._popNode());break;case c.SECTION:if(a=this._getValue(i.name),s(a))this._popNode(),this._expandLambda(i,a);else{var o=Array.isArray(a);o&&0===a.length&&(a=!1,o=!1);var l=!!a;i.inverted&&(l=!l),l?o?(this._popNode(),this._pushRepeaterNode(a.length,i.children,a)):(this._popNode(),this._pushContext(a),this._pushNodes(i.children)):this._popNode()}break;case c.TEXT:t+=i.text,this._popNode();break;case c.COMMENT:this._popNode();break;case c.PARTIAL:this._popNode(),this._expandPartial(i);break;case c.DELIMITER_CHANGE:this._popNode(),this._delimiters=i.delimiters.slice(0);break;case p:if(i.count<i.repeat){var h=i.count;0===h?this._pushContext(i.contexts[0]):this._replaceTopContext(i.contexts[h]),this._pushNodes(i.nodesReversed,!0),i.count++}else this._popNode();break;case LAMBDA_NODE_TYPE:this._popNode(),this._expandLambda(i)}this._checkStacks(),n=0===t.length||"\n"===t[t.length-1]}return t}},{key:"_pushNodes",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];this._stack=this._stack.concat(t?e:e.slice(0).reverse())}},{key:"_popNode",value:function(){this._stack.pop()}},{key:"_pushRepeaterNode",value:function(e,t,n){this._stack.push({type:p,count:0,repeat:e,nodesReversed:t.slice(0).reverse(),contexts:n})}},{key:"_pushContext",value:function(e){this._contextStack.push({context:e,sp:this._stack.length})}},{key:"_pushPartial",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?"":arguments[1];this._partialStack.push({name:e,indent:t,sp:this._stack.length})}},{key:"_replaceTopContext",value:function(e){this._contextStack[this._contextStack.length-1].context=e}},{key:"_checkStacks",value:function(){this._stack.length===this._contextStack[this._contextStack.length-1].sp&&this._contextStack.pop(),this._partialStack.length>0&&this._stack.length===this._partialStack[this._partialStack.length-1].sp&&this._partialStack.pop()}},{key:"_getValue",value:function(e){if("."===e)return this._contextStack[this._contextStack.length-1].context;for(var t=e.split("."),n=this._contextStack.length-1;n>=0;n--){var i=this._contextStack[n].context;if(null!==i&&"object"==typeof i){for(var r=i,a=!0,s=0;s<t.length;s++){var o=t[s];if(!r.hasOwnProperty(o)){a=!1;break}r=r[o]}if(a)return r}}return""}},{key:"_expandPartial",value:function(e){var t=e.name;if(this._partials.hasOwnProperty(t)){if(this._pushPartial(t,e.indent),this._partialStack.length>k)return void this._setError("Partial stack overflow: "+this._partialStack.map(function(e){return e.name}).concat([t]).join(" -> "),e.location);if(this._partialCached.hasOwnProperty(t))this._pushNodes(this._partialCached[t],!0);else{var n=new d.Parser(t),i=n.parse(this._partials[t]);if(null!==i){var r=this._partialCached[t]=i.children.slice(0).reverse();this._pushNodes(r,!0)}else this._error=n.error}}}},{key:"_expandLambda",value:function(e,t){var n=void 0;if(e.type===c.VARIABLE){var i=""+t(),r=new d.Parser("[lambda return value]");n=r.parse(i),e.unescaped||o(n,function(e){e.type===c.TEXT&&(e.text=_["default"](e.text))})}else if(e.type===c.SECTION){var a=new d.Parser("[lambda]",{delimiters:this._delimiters.slice(0)});n=a.parse(t(e.raw))}null!==n?this._pushNodes(n.children):this._error=parser.error}},{key:"_setError",value:function(e,t){this._error=new Error(e),this._error.location=t}},{key:"error",get:function(){return this._error}}]),e}();t.Renderer=f},function(e,t){/*!
	 * escape-html
	 * Copyright(c) 2012-2013 TJ Holowaychuk
	 * Copyright(c) 2015 Andreas Lubbe
	 * Copyright(c) 2015 Tiancheng "Timothy" Gu
	 * MIT Licensed
	 */
"use strict";function n(e){var t=""+e,n=i.exec(t);if(!n)return t;var r,a="",s=0,o=0;for(s=n.index;s<t.length;s++){switch(t.charCodeAt(s)){case 34:r="&quot;";break;case 38:r="&amp;";break;case 39:r="&#39;";break;case 60:r="&lt;";break;case 62:r="&gt;";break;default:continue}o!==s&&(a+=t.substring(o,s)),o=s+1,a+=r}return o!==s?a+t.substring(o,s):a}var i=/["'&<>]/;e.exports=n}])});